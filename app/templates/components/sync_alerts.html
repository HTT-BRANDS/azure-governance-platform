{# Sync Alerts Panel Component #}
<div class="bg-white rounded-lg shadow p-6 border-l-4 {{ 'border-wm-green-100' if stats.active == 0 else 'border-wm-red-100' }}">
    <div class="flex items-center justify-between mb-4">
        <div>
            <h3 class="text-lg font-semibold text-wm-gray-160">Sync Alerts</h3>
            <p class="text-sm text-wm-gray-100">
                {{ stats.active }} active alert{{ 's' if stats.active != 1 }}
                {% if stats.resolved > 0 %}
                ({{ stats.resolved }} resolved)
                {% endif %}
            </p>
        </div>
        <div class="p-3 rounded-full {{ 'bg-wm-green-10' if stats.active == 0 else 'bg-wm-red-10' }}">
            <svg class="w-6 h-6 {{ 'text-wm-green-100' if stats.active == 0 else 'text-wm-red-100' }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
            </svg>
        </div>
    </div>

    {# Stats Summary #}
    {% if stats.by_severity %}
    <div class="flex flex-wrap gap-2 mb-4">
        {% for severity, count in stats.by_severity.items() %}
        <span class="px-2 py-1 text-xs font-medium rounded
            {% if severity == 'critical' %}bg-wm-red-100 text-white
            {% elif severity == 'error' %}bg-wm-spark-100 text-wm-gray-160
            {% elif severity == 'warning' %}bg-wm-spark-50 text-wm-gray-160
            {% else %}bg-wm-blue-10 text-wm-gray-160{% endif %}">
            {{ severity.title() }}: {{ count }}
        </span>
        {% endfor %}
    </div>
    {% endif %}

    {# Alerts List #}
    <div class="space-y-3 max-h-96 overflow-y-auto">
        {% for alert in alerts %}
        <div class="p-3 rounded-lg border {{ 'border-wm-red-50 bg-wm-red-5' if alert.severity == 'critical' else ('border-wm-spark-50 bg-wm-spark-5' if alert.severity == 'error' else ('border-wm-spark-30 bg-wm-spark-5' if alert.severity == 'warning' else 'border-wm-blue-30 bg-wm-blue-5')) }}">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full
                            {% if alert.severity == 'critical' %}bg-wm-red-100
                            {% elif alert.severity == 'error' %}bg-wm-spark-100
                            {% elif alert.severity == 'warning' %}bg-wm-spark-50
                            {% else %}bg-wm-blue-100{% endif %}">
                        </span>
                        <span class="font-medium text-wm-gray-160 text-sm">{{ alert.title }}</span>
                    </div>
                    <p class="text-xs text-wm-gray-100 mt-1">{{ alert.message }}</p>
                    {% if alert.job_type %}
                    <div class="flex items-center gap-2 mt-2">
                        <span class="px-2 py-0.5 text-xs bg-wm-gray-10 text-wm-gray-100 rounded capitalize">{{ alert.job_type }}</span>
                        <span class="text-xs text-wm-gray-100">{{ alert.alert_type.replace('_', ' ').title() }}</span>
                    </div>
                    {% endif %}
                </div>
                <div class="text-right ml-2">
                    <span class="text-xs text-wm-gray-100">{{ alert.created_at[:10] if alert.created_at else 'Unknown' }}</span>
                    <button
                        hx-post="/api/v1/sync/alerts/{{ alert.id }}/resolve"
                        hx-swap="outerHTML"
                        hx-target="closest div.p-3"
                        class="mt-2 px-2 py-1 text-xs bg-wm-green-100 text-white rounded hover:bg-wm-green-110 transition-colors">
                        Resolve
                    </button>
                </div>
            </div>
        </div>
        {% else %}
        <div class="text-center py-8 text-wm-gray-100">
            <svg class="w-12 h-12 mx-auto mb-3 text-wm-green-100" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <p class="text-sm">No active alerts</p>
            <p class="text-xs mt-1">All sync jobs are healthy</p>
        </div>
        {% endfor %}
    </div>

    {# Alert Type Summary #}
    {% if stats.by_type %}
    <div class="mt-4 pt-4 border-t border-wm-gray-50">
        <h4 class="text-xs font-medium text-wm-gray-160 mb-2">Alert Types</h4>
        <div class="flex flex-wrap gap-2">
            {% for alert_type, count in stats.by_type.items() %}
            <span class="px-2 py-1 text-xs bg-wm-gray-10 text-wm-gray-100 rounded">
                {{ count }} {{ alert_type.replace('_', ' ').title() }}
            </span>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {# Auto-refresh indicator #}
    <div class="mt-4 flex items-center justify-between text-xs text-wm-gray-100">
        <span hx-get="/partials/sync-alerts" hx-trigger="every 30s" hx-swap="outerHTML" class="cursor-pointer hover:text-wm-blue-100">
            Auto-refreshing every 30s
        </span>
        <a href="/api/v1/sync/alerts" class="text-wm-blue-100 hover:underline">View all alerts â†’</a>
    </div>
</div>
